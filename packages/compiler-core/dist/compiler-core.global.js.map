{
  "version": 3,
  "sources": ["../src/index.ts", "../../shared/src/index.ts", "../src/runtimeHelpers.ts", "../src/ast.ts", "../src/codegen.ts", "../src/parse.ts", "../src/transforms/transformElement.ts", "../src/transforms/transformExpression.ts", "../src/transforms/transformText.ts", "../src/transform.ts"],
  "sourcesContent": ["import { generate } from \"./codegen\";\nimport { parse } from \"./parse\";\nimport { transform } from \"./transform\";\n\n/**\u89E3\u6790\u6A21\u7248\n * @param template \u6A21\u7248\u5B57\u7B26\u4E32\n */\nexport function compiler(template){\n  //\u5C06\u6A21\u7248\u8F6C\u6210\u62BD\u8C61\u8BED\u6CD5\u6811\n  const ast = parse(template);//\u8FD9\u91CC\u9700\u8981\u5C06html\u8BED\u6CD5\u8F6C\u5316\u6210js\u8BED\u6CD5\u2014\u2014\u7F16\u8BD1\u539F\u7406\n\n  // \u5BF9ast\u8BED\u6CD5\u6811\u8FDB\u884C\u4E00\u4E9B\u9884\u5904\u7406\n  // \u5728\u4EE3\u7801\u751F\u6210\u4E4B\u524D\u8981\u505A\u4E00\u4E9B\u8F6C\u5316\uFF0C\u5C06 <div>{{aa}} 123</div> --> createElementVnode('div',toDisplayString(aa) + 123)\n  // \u9700\u8981\u53BB\u641C\u96C6\u6240\u9700\u7684\u65B9\u6CD5 createElementVnode toDisplayString\n  // \u4E3A\u4E86\u5728\u751F\u6210\u4EE3\u7801\u7684\u65F6\u5019\u66F4\u65B9\u4FBF\u4F1A\u5728\u8F6C\u5316\u7684\u65F6\u5019\u751F\u6210\u4E00\u4E9B\u5C5E\u6027\n  // \u5C5E\u6027\u3001\u5143\u7D20\u3001\u8868\u8FBE\u5F0F\u3001\u6587\u672C\n  transform(ast);\n\n\n  // //\u4EE3\u7801\u751F\u6210\n  return generate(ast);//\u6700\u7EC8\u751F\u6210\u4EE3\u7801 \u548Cvue2\u4E00\u6837\n}\n", "type BoolFun = (param:any)=>boolean;\n\nexport const isObject:BoolFun = (val) => {\n  return typeof val === \"object\" && val !== null;\n}\n\nexport const isString:BoolFun = (val) => {\n  return typeof val === \"string\";\n}\n\nexport const isNumber:BoolFun = (val) => {\n  return typeof val === \"number\";\n}\n\nexport const isFunction:BoolFun = (val) => {\n  return typeof val === \"function\";\n}\n\nexport const isArray:BoolFun = Array.isArray;\nexport const assign = Object.assign;\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nexport const hasOwn = (value,key) => hasOwnProperty.call(value,key);\n\nexport const invokeArrayFns = (fns) => {\n  for(let i = 0;i < fns.length;i++){\n    fns[i]();\n  }\n}\n\n/**vue3\u63D0\u4F9B\u7684\u5F62\u72B6\u6807\u8BC6 */\nexport const enum ShapeFlags {\n  /**\u5143\u7D20 */\n  ELEMENT = 1,\n  /**\u51FD\u6570\u5F0F\u7EC4\u4EF6 */\n  FUNCTIONAL_COMPONENT = 1 << 1,\n  /**\u6709\u72B6\u6001\u7684\u7EC4\u4EF6 */\n  STATEFUL_COMPONENT = 1 << 2,\n  /**\u6587\u672C\u5B50\u8282\u70B9 */\n  TEXT_CHILDREN = 1 << 3,\n  /**\u6570\u7EC4\u5B50\u8282\u70B9 */\n  ARRAY_CHILDREN = 1 << 4,\n  /**\u63D2\u69FD\u5B50\u8282\u70B9 */\n  SLOTS_CHILDREN = 1 << 5,\n  /**Teleport \u7EC4\u4EF6 */\n  TELEPORT = 1 << 6,\n  /**Suspense \u7EC4\u4EF6 */\n  SUSPENSE = 1 << 7,\n  /**\u8981\u7F13\u5B58\u7684\u7EC4\u4EF6 */\n  COMPONENT_SHOULD_KEEP_ALIVE = 1 << 8,\n  /**\u5DF2\u7ECF\u7F13\u5B58\u4E86\u7684\u7EC4\u4EF6 */\n  COMPONENT_KEPT_ALIVE = 1 << 9,\n  /**\u7EC4\u4EF6 */\n  COMPONENT = ShapeFlags.STATEFUL_COMPONENT | ShapeFlags.FUNCTIONAL_COMPONENT\n}\n\n/**\u9776\u5411\u66F4\u65B0\u7C7B\u578B */\nexport const enum PatchFlags {\n  /**\u52A8\u6001\u6587\u672C\u8282\u70B9 */\n  TEXT = 1,\n  /**\u52A8\u6001 class */\n  CLASS = 1 << 1,\n  /**\u52A8\u6001 style */\n  STYLE = 1 << 2,\n  /**\u9664\u4E86 class/style \u7684\u52A8\u6001\u5C5E\u6027 */\n  PROPS = 1 << 3,\n  /**\u6709key\uFF0C\u9700\u8981\u5B8C\u6574diff */\n  FULL_PROPS = 1 << 4,\n  /**\u6302\u8F7D\u8FC7\u4E8B\u4EF6\u7684 */\n  HYDRATE_EVENTS = 1 << 5,\n  /**\u7A33\u5B9A\u5E8F\u5217\uFF0C\u5B50\u8282\u70B9\u987A\u5E8F\u4E0D\u4F1A\u6539\u53D8 */\n  STABLE_FRAGMENT = 1 << 6,\n  /**\u5B50\u8282\u70B9\u6709key\u7684fragment */\n  KEYED_FRAGMENT = 1 << 7,\n  /**\u5B50\u8282\u70B9\u6CA1\u6709key\u7684fragment */\n  UNKEYED_FRAGMENT = 1 << 8,\n  /**\u8FDB\u884C\u975Eprops\u6BD4\u8F83\uFF0Cref\u6BD4\u8F83 */\n  NEED_PATCH = 1 << 9,\n  /**\u52A8\u6001\u63D2\u69FD */\n  DYNAMIC_SLOTS = 1 << 10,\n  DEV_ROOT_FRAGMENT = 1 << 11,\n  /**\u8868\u793A\u9759\u6001\u82A5\u8482\u5A1C\uFF0C\u5185\u5BB9\u53D8\u5316\uFF0C\u4E0D\u6BD4\u8F83\u513F\u5B50 */\n  HOISTED = -1,\n  /**\u8868\u793Adiff\u7B97\u6CD5\u7ED3\u675F */\n  BAIL = -2\n}\n\n//\u4F4D\u8FD0\u7B97 & \uFF5C \u9002\u5408\u6743\u9650\u7684\u7EC4\u5408 \n// | \u901A\u5E38\u8868\u793A\u5305\u542B\n// & \u8868\u793A\u62E5\u6709\n//let add = 1,del = 1 << 1,edt = 1 << 2;\n//let per = add | del   \n//per & add ==> true\n//per & edt ==> false", "export const TO_DISPLAY_STRING = Symbol('toDisplayString')\nexport const CREATE_ELEMENT_VNODE = Symbol('createElementVNode')\n\nexport const helperMap = {\n  [TO_DISPLAY_STRING]:'toDisplayString',\n  [CREATE_ELEMENT_VNODE]:'createElementVNode'\n}", "import { CREATE_ELEMENT_VNODE } from \"./runtimeHelpers\";\n\n/**ast \u8282\u70B9\u7C7B\u578B */\nexport const enum NodeTypes {\n  /**\u6839\u8282\u70B9 */\n  ROOT,\n  /**\u5143\u7D20 */\n  ELEMENT,\n  /**\u6587\u672C */\n  TEXT,\n  /**\u6CE8\u91CA */\n  COMMENT,\n  /**\u7B80\u5355\u8868\u8FBE\u5F0F :src=\"xx\" */\n  SIMPLE_EXPRESSION,\n  /**\u6A21\u7248\u8868\u8FBE\u5F0F {{aa}} */\n  INTERPOLATION,\n  ATTRIBUTE,\n  DIRECTIVE,\n  //containers\n  /**\u590D\u5408\u8868\u8FBE\u5F0F {{aa}} abc */\n  COMPOUND_EXPRESSION,\n  IF,\n  IF_BRANCH,\n  FOR,\n  /**\u6587\u672C\u8C03\u7528 */\n  TEXT_CALL,\n  //codegen\n  /**\u5143\u7D20\u8C03\u7528 */\n  VNODE_CALL,\n  /**js\u8C03\u7528\u8868\u8FBE\u5F0F */\n  JS_CALL_EXPRESSION,\n}\n\n/**\u521B\u5EFA\u7528\u4E8E codegen \u7684\u865A\u62DF\u8282\u70B9 */\nexport function createVNodeCall(context,tag,props?,children?){\n  if(context){\n    context.helper(CREATE_ELEMENT_VNODE);\n  }\n\n  return {\n    // vue3 \u91CC\u9762\u8FD9\u91CC\u7684 type \u662F VNODE_CALL\n    // \u662F\u4E3A\u4E86 block \u800C mini-vue \u91CC\u9762\u6CA1\u6709\u5B9E\u73B0 block \n    // \u6240\u4EE5\u521B\u5EFA\u7684\u662F Element \u7C7B\u578B\u5C31\u591F\u7528\u4E86\n    type: NodeTypes.ELEMENT,\n    tag,\n    props,\n    children,\n  };\n}", "import { isString } from \"@vue/shared\";\nimport { NodeTypes } from \"./ast\";\nimport {\n  CREATE_ELEMENT_VNODE,\n  helperMap,\n  TO_DISPLAY_STRING,\n} from \"./runtimeHelpers\";\n\nexport function generate(ast, options = {}) {\n  // \u5148\u751F\u6210 context\n  const context = createCodegenContext(ast, options);\n  const { push, mode } = context;\n\n  // 1. \u5148\u751F\u6210 preambleContext\n\n  if (mode === \"module\") {\n    genModulePreamble(ast, context);\n  } else {\n    genFunctionPreamble(ast, context);\n  }\n\n  const functionName = \"render\";\n\n  const args = [\"_ctx\"];\n\n  // _ctx,aaa,bbb,ccc\n  // \u9700\u8981\u628A args \u5904\u7406\u6210 \u4E0A\u9762\u7684 string\n  const signature = args.join(\", \");\n  push(`function ${functionName}(${signature}) {`);\n  // \u8FD9\u91CC\u9700\u8981\u751F\u6210\u5177\u4F53\u7684\u4EE3\u7801\u5185\u5BB9\n  // \u5F00\u59CB\u751F\u6210 vnode tree \u7684\u8868\u8FBE\u5F0F\n  push(\"return \");\n  genNode(ast.codegenNode, context);\n\n  push(\"}\");\n\n  return {\n    code: context.code,\n  };\n}\n\nfunction genFunctionPreamble(ast: any, context: any) {\n  const { runtimeGlobalName, push, newline } = context;\n  const VueBinging = runtimeGlobalName;\n\n  const aliasHelper = (s) => `${helperMap[s]} : _${helperMap[s]}`;\n\n  if (ast.helpers.length > 0) {\n    push(\n      `\n        const { ${ast.helpers.map(aliasHelper).join(\", \")}} = ${VueBinging} \n\n      `\n    );\n  }\n\n  newline();\n  push(`return `);\n}\n\nfunction genNode(node: any, context: any) {\n  // \u751F\u6210\u4EE3\u7801\u7684\u89C4\u5219\u5C31\u662F\u8BFB\u53D6 node \uFF0C\u7136\u540E\u57FA\u4E8E\u4E0D\u540C\u7684 node \u6765\u751F\u6210\u5BF9\u5E94\u7684\u4EE3\u7801\u5757\n  // \u7136\u540E\u5C31\u662F\u628A\u4EE3\u7801\u5FEB\u7ED9\u62FC\u63A5\u5230\u4E00\u8D77\u5C31\u53EF\u4EE5\u4E86\n\n  switch (node.type) {\n    case NodeTypes.INTERPOLATION:\n      genInterpolation(node, context);\n      break;\n    case NodeTypes.SIMPLE_EXPRESSION:\n      genExpression(node, context);\n      break;\n\n    case NodeTypes.ELEMENT:\n      genElement(node, context);\n      break;\n\n    case NodeTypes.COMPOUND_EXPRESSION:\n      genCompoundExpression(node, context);\n      break;\n\n    case NodeTypes.TEXT:\n      genText(node, context);\n      break;\n\n    default:\n      break;\n  }\n}\n\nfunction genCompoundExpression(node: any, context: any) {\n  const { push } = context;\n  for (let i = 0; i < node.children.length; i++) {\n    const child = node.children[i];\n    if (isString(child)) {\n      push(child);\n    } else {\n      genNode(child, context);\n    }\n  }\n}\n\nfunction genText(node: any, context: any) {\n  // Implement\n  const { push } = context;\n\n  push(`'${node.content}'`);\n}\n\nfunction genElement(node, context) {\n  const { push, helper } = context;\n  const { tag, props, children } = node;\n\n  push(`${helper(CREATE_ELEMENT_VNODE)}(`);\n\n  genNodeList(genNullableArgs([tag, props, children]), context);\n\n  push(`)`);\n}\n\nfunction genNodeList(nodes: any, context: any) {\n  const { push } = context;\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i];\n\n    if (isString(node)) {\n      push(`${node}`);\n    } else {\n      genNode(node, context);\n    }\n    // node \u548C node \u4E4B\u95F4\u9700\u8981\u52A0\u4E0A \u9017\u53F7(,)\n    // \u4F46\u662F\u6700\u540E\u4E00\u4E2A\u4E0D\u9700\u8981 \"div\", [props], [children]\n    if (i < nodes.length - 1) {\n      push(\", \");\n    }\n  }\n}\n\nfunction genNullableArgs(args) {\n  // \u628A\u672B\u5C3E\u4E3Anull \u7684\u90FD\u5220\u9664\u6389\n  // vue3\u6E90\u7801\u4E2D\uFF0C\u540E\u9762\u53EF\u80FD\u4F1A\u5305\u542B patchFlag\u3001dynamicProps \u7B49\u7F16\u8BD1\u4F18\u5316\u7684\u4FE1\u606F\n  // \u800C\u8FD9\u4E9B\u4FE1\u606F\u6709\u53EF\u80FD\u662F\u4E0D\u5B58\u5728\u7684\uFF0C\u6240\u4EE5\u5728\u8FD9\u8FB9\u7684\u65F6\u5019\u9700\u8981\u5220\u9664\u6389\n  let i = args.length;\n  // \u8FD9\u91CC i-- \u7528\u7684\u8FD8\u662F\u7279\u522B\u7684\u5DE7\u5999\u7684\n  // \u5F53\u4E3A0 \u7684\u65F6\u5019\u81EA\u7136\u5C31\u9000\u51FA\u5FAA\u73AF\u4E86\n  while (i--) {\n    if (args[i] != null) break;\n  }\n\n  // \u628A\u4E3A falsy \u7684\u503C\u90FD\u66FF\u6362\u6210 \"null\"\n  return args.slice(0, i + 1).map((arg) => arg || \"null\");\n}\n\nfunction genExpression(node: any, context: any) {\n  context.push(node.content, node);\n}\n\nfunction genInterpolation(node: any, context: any) {\n  const { push, helper } = context;\n  push(`${helper(TO_DISPLAY_STRING)}(`);\n  genNode(node.content, context);\n  push(\")\");\n}\n\nfunction genModulePreamble(ast, context) {\n  // preamble \u5C31\u662F import \u8BED\u53E5\n  const { push, newline, runtimeModuleName } = context;\n\n  if (ast.helpers.length) {\n    // \u6BD4\u5982 ast.helpers \u91CC\u9762\u6709\u4E2A [toDisplayString]\n    // \u90A3\u4E48\u751F\u6210\u4E4B\u540E\u5C31\u662F import { toDisplayString as _toDisplayString } from \"vue\"\n    const code = `import {${ast.helpers\n      .map((s) => `${helperMap[s]} as _${helperMap[s]}`)\n      .join(\", \")} } from ${JSON.stringify(runtimeModuleName)}`;\n\n    push(code);\n  }\n\n  newline();\n  push(`export `);\n}\n\nfunction createCodegenContext(\n  ast: any,\n  { runtimeModuleName = \"vue\", runtimeGlobalName = \"Vue\", mode = \"function\" }\n): any {\n  const context = {\n    code: \"\",\n    mode,\n    runtimeModuleName,\n    runtimeGlobalName,\n    helper(key) {\n      return `_${helperMap[key]}`;\n    },\n    push(code) {\n      context.code += code;\n    },\n    newline() {\n      // \u6362\u65B0\u884C\n      // TODO \u9700\u8981\u989D\u5916\u5904\u7406\u7F29\u8FDB\n      context.code += \"\\n\";\n    },\n  };\n\n  return context;\n}\n", "import { NodeTypes } from \"./ast\";\n\n/**\u521B\u5EFA\u89E3\u6790\u4E0A\u4E0B\u6587 */\nfunction createParserContext(template){\n  return {\n    line:1,//\u5F53\u524D\u89E3\u6790\u5230\u7684\u884C\u6570\n    column:1,//\u5F53\u524D\u89E3\u6790\u5230\u5217\u6570\n    offset:0,//\u504F\u79FB\u91CF\n    source:template,//\u8FD9\u4E2A\u5B57\u6BB5\u4F1A\u88AB\u4E0D\u65AD\u526A\u5207 slice\n    originalSource:template//\u539F\u59CB\u6570\u636E\n  }\n}\n\n/**\u89E3\u6790\u662F\u5426\u7ED3\u675F */\nfunction isEnd(context){\n  const source = context.source;\n  if(source.startsWith(\"</\")) return true;\n  return !source\n}\n\nfunction getCursor(context){\n  let {line,column,offset} = context;\n  return {line,column,offset};\n}\n\n/**\u66F4\u65B0\u6700\u65B0\u7684\u884C\u3001\u5217\u3001\u504F\u79FB\u91CF\u4FE1\u606F */\nfunction advancePositionWithMutation(context,source,endIndex){\n  let linesCount = 0;//\u884C\u6570\n  let linePos = -1;\n\n  for(let i = 0;i < endIndex;i++){\n    //\u56DE\u8F66\u7684 ascii \u7801\u662F 10\n    if(source.charCodeAt(i) == 10){\n      linesCount++;\n      linePos = i;\n    }\n  }\n\n  context.line += linesCount;\n  context.column = linePos === -1 ? context.column + endIndex : endIndex - linePos;\n  context.offset += endIndex;\n}\n\n/**\u622A\u53D6\u548C\u66F4\u65B0\u5185\u5BB9 */\nfunction advanceBy(context,endIndex) {\n  //\u6BCF\u6B21\u5220\u9664\u5185\u5BB9\u7684\u65F6\u5019\u90FD\u8981\u66F4\u65B0\u6700\u65B0\u7684\u884C\u3001\u5217\u3001\u504F\u79FB\u91CF\u4FE1\u606F\n  let source = context.source\n  advancePositionWithMutation(context,source,endIndex);\n\n  context.source = source.slice(endIndex);\n}\n\n/**\u5904\u7406\u6587\u672C */\nfunction parseTextData(context,endIndex){\n  const rawText = context.source.slice(0,endIndex);\n  advanceBy(context,endIndex);\n  return rawText;\n}\n\n/**\u83B7\u53D6\u5F53\u524D\u5F00\u59CB\u548C\u7ED3\u675F\u7684\u4F4D\u7F6E */\nfunction getSelection(context,start,end?){\n  end = end || getCursor(context);\n  return {\n    start,\n    end,\n    source:context.originalSource.slice(start.offset,end.offset)\n  }\n}\n\n/**\u89E3\u6790\u6587\u672C */\nfunction parseText(context){\n  // \u5728\u89E3\u6790\u6587\u672C\u7684\u65F6\u5019\u8981\u770B\u540E\u9762\u5230\u90A3\u91CC\u7ED3\u675F\uFF0Cabc {{x}} <a></a>\n  let endTokens = ['<','{{'];\n  let endIndex = context.source.length;//\u9ED8\u8BA4\u5230\u6700\u540E\u7ED3\u675F\n  for(let i = 0;i < endTokens.length;i++){\n    let index = context.source.indexOf(endTokens[i],1);\n    if(index !== -1 && endIndex > index){\n      endIndex = index;\n    }\n  }\n\n  // \u521B\u5EFA\u884C\u5217\u4FE1\u606F\n\n  // \u5F00\u59CB\u6570\u636E\n  const start = getCursor(context);\n  // \u622A\u53D6\u5185\u5BB9\n  const content = parseTextData(context,endIndex);\n  \n  return {\n    type:NodeTypes.TEXT,\n    content:content,\n    loc:getSelection(context,start),//\u4F4D\u7F6E\u4FE1\u606F\n  }\n}\n\n/**\n * \u89E3\u6790\u8868\u8FBE\u5F0F\n */\nfunction parseInterpolation(context){\n  const start = getCursor(context);\n  const closeIndex = context.source.indexOf(\"}}\",2);//\u67E5\u627E\u7ED3\u675F\u7684\u5927\u62EC\u53F7\n\n  advanceBy(context,2);//\u53BB\u9664\u5F00\u5934\u7684 {{\n\n  const innerStart = getCursor(context);//\u8868\u8FBE\u5F0F\u5185\u5BB9\u5F00\u59CB\u4F4D\u7F6E\n  const innerEnd = getCursor(context);//\u8868\u8FBE\u5F0F\u5185\u5BB9\u4ECB\u7ECD\u4F4D\u7F6E\n\n  const rawContentLength = closeIndex - 2;//\u8868\u8FBE\u5F0F\u5185\u5BB9\u957F\u5EA6\n  let preContent = parseTextData(context,rawContentLength);//\u83B7\u53D6\u5185\u5BB9\u5E76\u5220\u9664\uFF0C\u66F4\u65B0\u4F4D\u7F6E\u4FE1\u606F\n  let content = preContent.trim();//\u53D6\u51FA\u524D\u540E\u7A7A\u683C\n  let startOffset =  preContent.indexOf(content);//\u5F00\u59CB\u7684\u504F\u79FB\u91CF {{ xxx }}\n  if(startOffset > 0){//\u524D\u9762\u6709\u7A7A\u683C\n    advancePositionWithMutation(innerStart,preContent,startOffset);//\u66F4\u65B0\u5F00\u59CB\u7684\u4F4D\u7F6E\u4FE1\u606F\n  }\n\n  let endOffset = startOffset + content.length\n  advancePositionWithMutation(innerEnd,preContent,endOffset);//\u66F4\u65B0\u7ED3\u675F\u7684\u4F4D\u7F6E\u4FE1\u606F\n\n  advanceBy(context,2);//\u53BB\u9664\u7ED3\u5C3E\u7684 }}\n  \n  return {\n    type:NodeTypes.INTERPOLATION,//\u8868\u8FBE\u5F0F\n    content:{\n      type:NodeTypes.SIMPLE_EXPRESSION,//\u7B80\u5355\u8868\u8FBE\u5F0F\n      content,\n      loc:getSelection(context,innerStart,innerEnd)\n    },\n    loc:getSelection(context,start)\n  }\n  \n}\n\n/**\u53BB\u9664\u7A7A\u683C */\nfunction advanceBySpaces(context) {\n  let match = /^[ \\t\\r\\n]+/.exec(context.source);\n  if(match){\n    advanceBy(context,match[0].length);//\u5220\u9664 <div\n  }\n}\n\n/**\u89E3\u6790\u5C5E\u6027\u503C */\nfunction parseAttributeValue(context){\n  let start = getCursor(context);\n  let quote = context.source[0];\n  let content;\n  if(quote === \"'\" || quote === '\"'){\n    advanceBy(context,1);//\u5220\u9664 '|\"\n    const endIndex = context.source.indexOf(quote)\n    content = parseTextData(context,endIndex);\n    advanceBy(context,1);//\u5220\u9664 '|\"\n  }\n  return {\n    content,\n    loc:getSelection(context,start),\n  }\n}\n\n/**\u89E3\u6790\u5C5E\u6027\u5BF9 */\nfunction parseAttribute(context){\n  let start = getCursor(context);\n  //\u5C5E\u6027\u540D\n  let match = /^[^\\t\\r\\n\\f />][^\\t\\r\\n\\f />=]*/.exec(context.source);\n  let name = match[0];\n\n  advanceBy(context,name.length);//\u53BB\u6389\u5C5E\u6027\u540D\n\n  advanceBySpaces(context);//\u5220\u6389\u7A7A\u683C a = \"1\"\n  advanceBy(context,1);//\u5220\u6389 =\n\n  let value = parseAttributeValue(context);\n\n  return {\n    type:NodeTypes.ATTRIBUTE,\n    name,\n    value:{\n      type:NodeTypes.TEXT,\n      ...value,\n    },\n    loc:getSelection(context,start),\n  }\n}\n\n/**\u89E3\u6790\u6807\u7B7E\u5C5E\u6027 */\nfunction parseAttributes(context){\n  const props = [];\n\n  while(context.source.length && !context.source.startsWith(\">\")){\n    const prop = parseAttribute(context);\n    props.push(prop);\n    advanceBySpaces(context);\n  }\n  \n  return props;\n}\n\n/**\u89E3\u6790\u6807\u7B7E */\nfunction parseTag(context){\n  let start = getCursor(context);\n  \n  //\u6807\u7B7E <br /> <div class=\"ss\"> </div>\n  let match = /^<\\/?([a-z][^ \\t\\r\\n>]*)/.exec(context.source);\n  const tag = match[1];//\u6807\u7B7E\u540D\n  advanceBy(context,match[0].length);//\u5220\u9664 <div\n  advanceBySpaces(context);//\u53BB\u9664\u7A7A\u683C\n\n  //\u89E3\u6790\u5C5E\u6027 <div class=\"ss\"> </div>\n  let props = parseAttributes(context);\n\n  /**\u662F\u5426\u662F\u81EA\u95ED\u548C\u6807\u7B7E */\n  let isSelfClosing = context.source.startsWith(\"/>\");\n\n  advanceBy(context,isSelfClosing ? 2 : 1);//\u5220\u9664 /> \u6216\u8005 >\n\n  return {\n    type:NodeTypes.ELEMENT,\n    tag,\n    props,\n    isSelfClosing,\n    children:[],\n    loc:getSelection(context,start)\n  }\n}\n\n/**\u89E3\u6790\u6807\u7B7E */\nfunction parseElement(context){\n  //\u5047\u5982\u8F93\u5165\u7684\u662F <div></div>\n  let ele = parseTag(context);//\u5904\u7406\u4E4B\u540E\u5C31\u662F </div>\n  \n  //\u5904\u7406\u5176\u4E2D\u7684\u5185\u5BB9\uFF08\u5B50\u5143\u7D20\uFF09\n  let children = parseChildren(context);//\u53EF\u80FD\u6CA1\u6709\u513F\u5B50\uFF0C\u9700\u8981\u5728parseChildren\u7684isEnd\u6DFB\u52A0\u6761\u4EF6\uFF0C\u9047\u5230 </ \u4E5F\u76F4\u63A5\u7ED3\u675F\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u6B7B\u5FAA\u73AF\n\n  if(context.source.startsWith(\"</\")){//\u53BB\u9664 </div>\n    parseTag(context)\n  }\n  // \u66F4\u65B0\u4F4D\u7F6E\u4FE1\u606F\n  ele.loc = getSelection(context,ele.loc.start);\n  ele.children = children;\n  return ele;\n}\n\n/**\u5C06\u6A21\u7248\u8F6C\u6210\u62BD\u8C61\u8BED\u6CD5\u6811 */\nexport function parse(template) {\n\n  // \u89E3\u6790\u89C4\u5219\u5C31\u662F\u4E00\u4E2A\u4E2A\u5B57\u7B26\u8FDB\u884C\u5224\u65AD\uFF0C\u5E76\u4E14\u89E3\u6790\u5B8C\u6BD5\u540E\u5220\u9664\u5DF2\u7ECF\u89E3\u6790\u8FC7\u7684\u5B57\u7B26\u4E32\n\n  // \u521B\u5EFA\u4E00\u4E2A\u89E3\u6790\u4E0A\u4E0B\u6587\uFF08\u89E3\u6790\u4F4D\u7F6E\u6807\u8BB0\u7B49\uFF09\u6765\u8FDB\u884C\u5904\u7406\n  const context = createParserContext(template);\n\n  let start = getCursor(context);\n\n  //\u89E3\u6790\u5185\u5BB9\uFF08\u5B50\u5143\u7D20\uFF09\n  let nodes = createRoot(parseChildren(context),getSelection(context,start));\n  \n  return nodes\n}\n\n/**\u521B\u5EFA Fragment \u5305\u88F9\u5B50\u8282\u70B9 */\nfunction createRoot(children,loc){\n  return {\n    type:NodeTypes.ROOT,\n    children,\n    loc,\n    helpers: [],\n  }\n}\n\n/**\u89E3\u6790\u5185\u5BB9\uFF08\u5B50\u5143\u7D20\uFF09 */\nfunction parseChildren(context){\n  /**\n   * \u5185\u5BB9\u60C5\u51B5\n   * 1. <  :\u5143\u7D20\n   * 2. {{}} :\u8868\u8FBE\u5F0F\n   * 3. \u5176\u4ED6\u60C5\u51B5 :\u6587\u672C\n   */\n  const nodes = [];\n  while(!isEnd(context)){\n    const source = context.source;\n    let node;\n    if(source.startsWith(\"{{\")){//\u8868\u8FBE\u5F0F\n      node = parseInterpolation(context);\n    }else if(source[0] == \"<\"){//\u5143\u7D20\n      node = parseElement(context);\n    }\n    if(!node){//\u6587\u672C\n      node = parseText(context);\n    }\n    nodes.push(node);\n  }\n  //\u53BB\u9664\u6CA1\u6709\u610F\u4E49\u7684\u7A7A\u767D\u8282\u70B9\n  nodes.forEach((node,i) => {\n    if(node.type === NodeTypes.TEXT && !/[^\\t\\r\\n\\f ]/.test(node.content)){\n      nodes[i] = null;\n    }\n  })\n\n  return nodes.filter(Boolean);\n}", "import { createVNodeCall, NodeTypes } from \"../ast\";\n\nexport function transformElement(node,context){\n  //\u671F\u671B\u7ED9\u6240\u6709\u513F\u5B50\u5904\u7406\u5B8C\u540E\uFF0C\u7ED9\u5143\u7D20\u91CD\u65B0\u6DFB\u52A0children\u5C5E\u6027\n  //\u5E76\u4E14\u662F\u5148\u8F6C\u5316\u5B8C\u513F\u5B50\u7684\u518D\u8F6C\u5316\u7236\u7EA7\u7684\n  //(\u53EF\u4EE5\u7528\u9000\u51FA\u51FD\u6570\u5904\u7406\uFF1A\u5C31\u662F\u8FD4\u56DE\u4E00\u4E2A\u51FD\u6570\uFF0C\u5F53\u6267\u884C\u5904\u7406\u51FD\u6570\u4E4B\u540E\u518D\u6267\u884C\u8FD4\u56DE\u7684\u51FD\u6570)\n  if(node.type === NodeTypes.ELEMENT){\n\n    return () => {\n      // \u8FD9\u91CC\u6CA1\u6709\u5B9E\u73B0 block \u6240\u4EE5\u8FD9\u91CC\u76F4\u63A5\u521B\u5EFA element \n      \n      // \u8FD9\u91CC\u5BF9\u8282\u70B9\u7684 props \u548C children \u8FDB\u884C\u5904\u7406\u751F\u6210\u7528\u4E8E codegen \u7684\u7ED3\u6784\n      const vnodeTag = `'${node.tag}'`;\n      const vnodeProps = node.props;//\u5C5E\u6027\n      let vnodeChildren = node.children;//\u5B50\u8282\u70B9\n      if (node.children.length > 0) {\n        if (node.children.length === 1) {\n          // \u53EA\u6709\u4E00\u4E2A\u5B69\u5B50\u8282\u70B9 \uFF0C\u90A3\u4E48\u5F53\u751F\u6210 render \u51FD\u6570\u7684\u65F6\u5019\u5C31\u4E0D\u7528 [] \u5305\u88F9\n          const child = node.children[0];\n          vnodeChildren = child;\n        }\n      }\n\n      // \u521B\u5EFA\u4E00\u4E2A\u65B0\u7684 node \u7528\u4E8E codegen \u7684\u65F6\u5019\u4F7F\u7528\n      node.codegenNode = createVNodeCall(\n        context,\n        vnodeTag,\n        vnodeProps,\n        vnodeChildren\n      );\n    }\n  }\n}", "import { NodeTypes } from \"../ast\";\n\n/**\u8868\u8FBE\u5F0F\u7684\u8F6C\u5316 */\nexport function transformExpression(node,context){\n  // \u5BF9\u8868\u8FBE\u5F0F\u53EF\u4EE5\u76F4\u63A5\u8FDB\u884C\u8F6C\u5316 {{aa}} -> _ctx.aa\n  // \u5E76\u4E14\u9700\u8981\u5728 context.helpers \u6DFB\u52A0\u65B9\u6CD5 toDisplayString\n  \n  if(node.type === NodeTypes.INTERPOLATION){\n    let content = node.content.content;\n    node.content.content = `_ctx.${content}`;\n  }\n}", "import { NodeTypes } from \"../ast\";\n\nexport function transformText(node,context){\n  //\u671F\u671B\u5C06\u591A\u4E2A\u5B50\u8282\u70B9\u62FC\u51D1\u4E2D\u4E00\u8D77\n  //\u4F46\u662F\u9700\u8981\u5728\u9047\u5230\u5143\u7D20\u7684\u65F6\u5019\u624D\u80FD\u5904\u7406\u591A\u4E2A\u8282\u70B9\n  if(node.type === NodeTypes.ELEMENT || node.type === NodeTypes.ROOT){\n    // \u5728 exit \u7684\u65F6\u671F\u6267\u884C\n    // \u4E0B\u9762\u7684\u903B\u8F91\u4F1A\u6539\u53D8 ast \u6811\n    // \u6709\u4E9B\u903B\u8F91\u662F\u9700\u8981\u5728\u6539\u53D8\u4E4B\u524D\u505A\u5904\u7406\u7684\n    return () => {\n      // hi,{{msg}}\n      // \u4E0A\u9762\u7684\u6A21\u5757\u4F1A\u751F\u62102\u4E2A\u8282\u70B9\uFF0C\u4E00\u4E2A\u662F text \u4E00\u4E2A\u662F interpolation \u7684\u8BDD\n      // \u751F\u6210\u7684 render \u51FD\u6570\u5E94\u8BE5\u4E3A \"hi,\" + _toDisplayString(_ctx.msg)\n      // \u8FD9\u91CC\u9762\u5C31\u4F1A\u6D89\u53CA\u5230\u6DFB\u52A0\u4E00\u4E2A \u201C+\u201D \u64CD\u4F5C\u7B26\n      // \u90A3\u8FD9\u91CC\u7684\u903B\u8F91\u5C31\u662F\u5904\u7406\u5B83\n\n      // \u68C0\u6D4B\u4E0B\u4E00\u4E2A\u8282\u70B9\u662F\u4E0D\u662F text \u7C7B\u578B\uFF0C\u5982\u679C\u662F\u7684\u8BDD\uFF0C \u90A3\u4E48\u4F1A\u521B\u5EFA\u4E00\u4E2A COMPOUND \u7C7B\u578B\n      // COMPOUND \u7C7B\u578B\u628A 2\u4E2A text || interpolation \u5305\u88F9\uFF08\u76F8\u5F53\u4E8E\u662F\u7236\u7EA7\u5BB9\u5668\uFF09\n\n      const children = node.children;\n      let currentContainer;\n\n      for (let i = 0; i < children.length; i++) {\n        const child = children[i];\n\n        if (isText(child)) {\n          // \u770B\u770B\u4E0B\u4E00\u4E2A\u8282\u70B9\u662F\u4E0D\u662F text \u7C7B\n          for (let j = i + 1; j < children.length; j++) {\n            const next = children[j];\n            if (isText(next)) {\n              // currentContainer \u7684\u76EE\u7684\u662F\u628A\u76F8\u90BB\u7684\u8282\u70B9\u90FD\u653E\u5230\u4E00\u4E2A \u5BB9\u5668\u5185\n              if (!currentContainer) {\n                currentContainer = children[i] = {\n                  type: NodeTypes.COMPOUND_EXPRESSION,\n                  loc: child.loc,\n                  children: [child],\n                };\n              }\n\n              currentContainer.children.push(` + `, next);\n              // \u628A\u5F53\u524D\u7684\u8282\u70B9\u653E\u5230\u5BB9\u5668\u5185, \u7136\u540E\u5220\u9664\u6389j\n              children.splice(j, 1);\n              // \u56E0\u4E3A\u628A j \u5220\u9664\u4E86\uFF0C\u6240\u4EE5\u8FD9\u91CC\u5C31\u5C11\u4E86\u4E00\u4E2A\u5143\u7D20\uFF0C\u90A3\u4E48 j \u9700\u8981 --\n              j--;\n            } else {\n              currentContainer = undefined;\n              break;\n            }\n          }\n        }\n      }\n    };\n  }\n}\n\nexport function isText(node) {\n  return node.type === NodeTypes.INTERPOLATION || node.type === NodeTypes.TEXT;\n}", "import { NodeTypes } from \"./ast\";\nimport { TO_DISPLAY_STRING } from \"./runtimeHelpers\";\nimport { transformElement } from \"./transforms/transformElement\";\nimport { transformExpression } from \"./transforms/transformExpression\";\nimport { transformText } from \"./transforms/transformText\";\n\n/**\u521B\u5EFA\u8F6C\u5316\u4E0A\u4E0B\u6587  */\nfunction createTransformContext(root){\n  const context = {\n    currentNode:root,//\u5F53\u524D\u6B63\u5728\u8F6C\u5316\u7684\u8282\u70B9\n    parent:null,//\u5F53\u524D\u6B63\u5728\u8F6C\u5316\u7684\u8282\u70B9\u7684\u7236\u8282\u70B9\n    helpers:new Map(),//\u5B58\u50A8\u8F6C\u5316\u7528\u5230\u65B9\u6CD5\u7684\u6B21\u6570\uFF0C\u7528\u6765\u505A\u4F18\u5316\uFF0C\u8D85\u8FC720\u4E2A\u76F8\u540C\u7684\u8282\u70B9\u4F1A\u8F6C\u5316\u6210\u5B57\u7B26\u4E32\n    helper(name){//g\u6839\u636E\u4F7F\u7528\u8FC7\u7684\u65B9\u6CD5\u8FDB\u884C\u4F18\u5316\n      const count = context.helpers.get(name) || 0;\n      context.helpers.set(name,count+1);\n      return name;\n    },\n    nodeTransforms:[\n      transformElement,\n      transformText,\n      transformExpression\n    ]\n  }\n  return context;\n}\n\n/**\u904D\u5386\u8282\u70B9\u8FDB\u884C\u5904\u7406 */\nfunction traverse(node,context){\n  context.currentNode = node;\n  const transforms = context.nodeTransforms;\n  const exitFns = [];//\u9000\u51FA\u51FD\u6570\u5217\u8868\n  for(let i = 0;i < transforms.length;i++){\n    let onExit = transforms[i](node,context);//\u5728\u6267\u884C\u7684\u65F6\u5019\u6709\u53EF\u80FD\u4F1A\u628A\u8FD9\u4E2Anode\u5220\u9664\u6389\n    if(onExit) exitFns.push(onExit);\n    //\u5982\u679C\u5F53\u524D\u8282\u70B9\u88AB\u5220\u9664\u5C31\u4E0D\u7528\u5904\u7406\u513F\u5B50\u4E86\n    if(!context.currentNode) return;\n  }\n  //\u7EE7\u7EED\u5904\u7406\u5B50\u8282\u70B9\uFF0C\u5143\u7D20 \u548C \u6839\u8282\u70B9\u624D\u6709\u5B50\u8282\u70B9\n  switch(node.type){\n    case NodeTypes.INTERPOLATION:\n      // \u5BF9\u4E8E\u8868\u8FBE\u5F0F\u9700\u8981\u4F7F\u7528 toDisplayString \u65B9\u6CD5\u6765\u5904\u7406\n      // {{aa}} -> _ctx.aa -> toDisplayString(_ctx.aa)\n      context.helper(TO_DISPLAY_STRING);\n      break;\n    case NodeTypes.ELEMENT:\n    case NodeTypes.ROOT:\n      for(let i = 0;i < node.children.length;i++){\n        context.parent = node;\n        traverse(node.children[i],context);\n      }\n  }\n  // context.currentNode \u5728\u8FDB\u5165\u9012\u5F52\u51FD\u6570\u7684\u65F6\u5019\u4F1A\u6539\u53D8\uFF0C\u8FD9\u91CC\u9700\u8981\u91CD\u7F6E\u4E00\u4E0B\n  context.currentNode = node;\n  // \u5012\u5E8F\u6267\u884C\u9000\u51FA\u51FD\u6570\uFF0C\u5148\u6267\u884C\u5B50\u518D\u6267\u884C\u7236\u7684\n  let i = exitFns.length;\n  while(i--){\n    exitFns[i]();\n  }\n}\n\n/**\u7ED9\u6839\u8282\u70B9\u4E5F\u6DFB\u52A0\u4E0A codegen \u6240\u9700\u8981\u7684\u6570\u636E */\nfunction createRootCodegen(root: any, context: any) {\n  const { children } = root;\n\n  // \u53EA\u652F\u6301\u6709\u4E00\u4E2A\u6839\u8282\u70B9\n  // \u5E76\u4E14\u8FD8\u662F\u4E00\u4E2A single text node\n  const child = children[0];\n\n  // \u5982\u679C\u662F element \u7C7B\u578B\u7684\u8BDD \uFF0C \u90A3\u4E48\u6211\u4EEC\u9700\u8981\u628A\u5B83\u7684 codegenNode \u8D4B\u503C\u7ED9 root\n  // root \u5176\u5B9E\u662F\u4E2A\u7A7A\u7684\u4EC0\u4E48\u6570\u636E\u90FD\u6CA1\u6709\u7684\u8282\u70B9\n  // \u6240\u4EE5\u8FD9\u91CC\u9700\u8981\u989D\u5916\u7684\u5904\u7406 codegenNode\n  // codegenNode \u7684\u76EE\u7684\u662F\u4E13\u95E8\u4E3A\u4E86 codegen \u51C6\u5907\u7684  \u4E3A\u7684\u5C31\u662F\u548C ast \u7684 node \u5206\u79BB\u5F00\n  if (child.type === NodeTypes.ELEMENT && child.codegenNode) {\n    const codegenNode = child.codegenNode;\n    root.codegenNode = codegenNode;\n  } else {\n    root.codegenNode = child;\n  }\n}\n\n/**\u8F6C\u5316/\u9884\u5904\u7406 ast */\nexport function transform(ast) {\n  //\u521B\u5EFA\u8F6C\u5316\u4E0A\u4E0B\u6587 \n  const context = createTransformContext(ast);\n  //\u904D\u5386\u8282\u70B9\u8FDB\u884C\u5904\u7406\n  traverse(ast,context);\n  //\u7ED9\u6839\u8282\u70B9\u4E5F\u8FDB\u884C\u5904\u7406\n  createRootCodegen(ast, context);\n  //\u4FDD\u5B58\u6240\u6709\u4F7F\u7528\u7684 \u8F6C\u5316\u65B9\u6CD5\u5230\u6839\u8282\u70B9\u4E0A\n  ast.helpers.push(...context.helpers.keys());\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;;;ACMO,MAAM,WAAmB,CAAC,QAAQ;AACvC,WAAO,OAAO,QAAQ;AAAA,EACxB;AAUO,MAAM,UAAkB,MAAM;;;AClB9B,MAAM,oBAAoB,OAAO,iBAAiB;AAClD,MAAM,uBAAuB,OAAO,oBAAoB;AAExD,MAAM,YAAY;AAAA,IACvB,CAAC,oBAAmB;AAAA,IACpB,CAAC,uBAAsB;AAAA,EACzB;;;AC4BO,WAAS,gBAAgB,SAAQ,KAAI,OAAO,UAAU;AAC3D,QAAG,SAAQ;AACT,cAAQ,OAAO,oBAAoB;AAAA,IACrC;AAEA,WAAO;AAAA,MAIL,MAAM;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;;;ACxCO,WAAS,SAAS,KAAK,UAAU,CAAC,GAAG;AAE1C,UAAM,UAAU,qBAAqB,KAAK,OAAO;AACjD,UAAM,EAAE,MAAM,KAAK,IAAI;AAIvB,QAAI,SAAS,UAAU;AACrB,wBAAkB,KAAK,OAAO;AAAA,IAChC,OAAO;AACL,0BAAoB,KAAK,OAAO;AAAA,IAClC;AAEA,UAAM,eAAe;AAErB,UAAM,OAAO,CAAC,MAAM;AAIpB,UAAM,YAAY,KAAK,KAAK,IAAI;AAChC,SAAK,YAAY,gBAAgB,cAAc;AAG/C,SAAK,SAAS;AACd,YAAQ,IAAI,aAAa,OAAO;AAEhC,SAAK,GAAG;AAER,WAAO;AAAA,MACL,MAAM,QAAQ;AAAA,IAChB;AAAA,EACF;AAEA,WAAS,oBAAoB,KAAU,SAAc;AACnD,UAAM,EAAE,mBAAmB,MAAM,QAAQ,IAAI;AAC7C,UAAM,aAAa;AAEnB,UAAM,cAAc,CAAC,MAAM,GAAG,UAAU,SAAS,UAAU;AAE3D,QAAI,IAAI,QAAQ,SAAS,GAAG;AAC1B;AAAA,QACE;AAAA,kBACY,IAAI,QAAQ,IAAI,WAAW,EAAE,KAAK,IAAI,QAAQ;AAAA;AAAA;AAAA,MAG5D;AAAA,IACF;AAEA,YAAQ;AACR,SAAK,SAAS;AAAA,EAChB;AAEA,WAAS,QAAQ,MAAW,SAAc;AAIxC,YAAQ,KAAK;AAAA;AAET,yBAAiB,MAAM,OAAO;AAC9B;AAAA;AAEA,sBAAc,MAAM,OAAO;AAC3B;AAAA;AAGA,mBAAW,MAAM,OAAO;AACxB;AAAA;AAGA,8BAAsB,MAAM,OAAO;AACnC;AAAA;AAGA,gBAAQ,MAAM,OAAO;AACrB;AAAA;AAGA;AAAA;AAAA,EAEN;AAEA,WAAS,sBAAsB,MAAW,SAAc;AACtD,UAAM,EAAE,KAAK,IAAI;AACjB,aAAS,IAAI,GAAG,IAAI,KAAK,SAAS,QAAQ,KAAK;AAC7C,YAAM,QAAQ,KAAK,SAAS;AAC5B,UAAI,SAAS,KAAK,GAAG;AACnB,aAAK,KAAK;AAAA,MACZ,OAAO;AACL,gBAAQ,OAAO,OAAO;AAAA,MACxB;AAAA,IACF;AAAA,EACF;AAEA,WAAS,QAAQ,MAAW,SAAc;AAExC,UAAM,EAAE,KAAK,IAAI;AAEjB,SAAK,IAAI,KAAK,UAAU;AAAA,EAC1B;AAEA,WAAS,WAAW,MAAM,SAAS;AACjC,UAAM,EAAE,MAAM,OAAO,IAAI;AACzB,UAAM,EAAE,KAAK,OAAO,SAAS,IAAI;AAEjC,SAAK,GAAG,OAAO,oBAAoB,IAAI;AAEvC,gBAAY,gBAAgB,CAAC,KAAK,OAAO,QAAQ,CAAC,GAAG,OAAO;AAE5D,SAAK,GAAG;AAAA,EACV;AAEA,WAAS,YAAY,OAAY,SAAc;AAC7C,UAAM,EAAE,KAAK,IAAI;AACjB,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,YAAM,OAAO,MAAM;AAEnB,UAAI,SAAS,IAAI,GAAG;AAClB,aAAK,GAAG,MAAM;AAAA,MAChB,OAAO;AACL,gBAAQ,MAAM,OAAO;AAAA,MACvB;AAGA,UAAI,IAAI,MAAM,SAAS,GAAG;AACxB,aAAK,IAAI;AAAA,MACX;AAAA,IACF;AAAA,EACF;AAEA,WAAS,gBAAgB,MAAM;AAI7B,QAAI,IAAI,KAAK;AAGb,WAAO,KAAK;AACV,UAAI,KAAK,MAAM;AAAM;AAAA,IACvB;AAGA,WAAO,KAAK,MAAM,GAAG,IAAI,CAAC,EAAE,IAAI,CAAC,QAAQ,OAAO,MAAM;AAAA,EACxD;AAEA,WAAS,cAAc,MAAW,SAAc;AAC9C,YAAQ,KAAK,KAAK,SAAS,IAAI;AAAA,EACjC;AAEA,WAAS,iBAAiB,MAAW,SAAc;AACjD,UAAM,EAAE,MAAM,OAAO,IAAI;AACzB,SAAK,GAAG,OAAO,iBAAiB,IAAI;AACpC,YAAQ,KAAK,SAAS,OAAO;AAC7B,SAAK,GAAG;AAAA,EACV;AAEA,WAAS,kBAAkB,KAAK,SAAS;AAEvC,UAAM,EAAE,MAAM,SAAS,kBAAkB,IAAI;AAE7C,QAAI,IAAI,QAAQ,QAAQ;AAGtB,YAAM,OAAO,WAAW,IAAI,QACzB,IAAI,CAAC,MAAM,GAAG,UAAU,UAAU,UAAU,IAAI,EAChD,KAAK,IAAI,YAAY,KAAK,UAAU,iBAAiB;AAExD,WAAK,IAAI;AAAA,IACX;AAEA,YAAQ;AACR,SAAK,SAAS;AAAA,EAChB;AAEA,WAAS,qBACP,KACA,EAAE,oBAAoB,OAAO,oBAAoB,OAAO,OAAO,WAAW,GACrE;AACL,UAAM,UAAU;AAAA,MACd,MAAM;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,MACA,OAAO,KAAK;AACV,eAAO,IAAI,UAAU;AAAA,MACvB;AAAA,MACA,KAAK,MAAM;AACT,gBAAQ,QAAQ;AAAA,MAClB;AAAA,MACA,UAAU;AAGR,gBAAQ,QAAQ;AAAA,MAClB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;;;ACzMA,WAAS,oBAAoB,UAAS;AACpC,WAAO;AAAA,MACL,MAAK;AAAA,MACL,QAAO;AAAA,MACP,QAAO;AAAA,MACP,QAAO;AAAA,MACP,gBAAe;AAAA,IACjB;AAAA,EACF;AAGA,WAAS,MAAM,SAAQ;AACrB,UAAM,SAAS,QAAQ;AACvB,QAAG,OAAO,WAAW,IAAI;AAAG,aAAO;AACnC,WAAO,CAAC;AAAA,EACV;AAEA,WAAS,UAAU,SAAQ;AACzB,QAAI,EAAC,MAAK,QAAO,OAAM,IAAI;AAC3B,WAAO,EAAC,MAAK,QAAO,OAAM;AAAA,EAC5B;AAGA,WAAS,4BAA4B,SAAQ,QAAO,UAAS;AAC3D,QAAI,aAAa;AACjB,QAAI,UAAU;AAEd,aAAQ,IAAI,GAAE,IAAI,UAAS,KAAI;AAE7B,UAAG,OAAO,WAAW,CAAC,KAAK,IAAG;AAC5B;AACA,kBAAU;AAAA,MACZ;AAAA,IACF;AAEA,YAAQ,QAAQ;AAChB,YAAQ,SAAS,YAAY,KAAK,QAAQ,SAAS,WAAW,WAAW;AACzE,YAAQ,UAAU;AAAA,EACpB;AAGA,WAAS,UAAU,SAAQ,UAAU;AAEnC,QAAI,SAAS,QAAQ;AACrB,gCAA4B,SAAQ,QAAO,QAAQ;AAEnD,YAAQ,SAAS,OAAO,MAAM,QAAQ;AAAA,EACxC;AAGA,WAAS,cAAc,SAAQ,UAAS;AACtC,UAAM,UAAU,QAAQ,OAAO,MAAM,GAAE,QAAQ;AAC/C,cAAU,SAAQ,QAAQ;AAC1B,WAAO;AAAA,EACT;AAGA,WAAS,aAAa,SAAQ,OAAM,KAAK;AACvC,UAAM,OAAO,UAAU,OAAO;AAC9B,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA,QAAO,QAAQ,eAAe,MAAM,MAAM,QAAO,IAAI,MAAM;AAAA,IAC7D;AAAA,EACF;AAGA,WAAS,UAAU,SAAQ;AAEzB,QAAI,YAAY,CAAC,KAAI,IAAI;AACzB,QAAI,WAAW,QAAQ,OAAO;AAC9B,aAAQ,IAAI,GAAE,IAAI,UAAU,QAAO,KAAI;AACrC,UAAI,QAAQ,QAAQ,OAAO,QAAQ,UAAU,IAAG,CAAC;AACjD,UAAG,UAAU,MAAM,WAAW,OAAM;AAClC,mBAAW;AAAA,MACb;AAAA,IACF;AAKA,UAAM,QAAQ,UAAU,OAAO;AAE/B,UAAM,UAAU,cAAc,SAAQ,QAAQ;AAE9C,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA,KAAI,aAAa,SAAQ,KAAK;AAAA,IAChC;AAAA,EACF;AAKA,WAAS,mBAAmB,SAAQ;AAClC,UAAM,QAAQ,UAAU,OAAO;AAC/B,UAAM,aAAa,QAAQ,OAAO,QAAQ,MAAK,CAAC;AAEhD,cAAU,SAAQ,CAAC;AAEnB,UAAM,aAAa,UAAU,OAAO;AACpC,UAAM,WAAW,UAAU,OAAO;AAElC,UAAM,mBAAmB,aAAa;AACtC,QAAI,aAAa,cAAc,SAAQ,gBAAgB;AACvD,QAAI,UAAU,WAAW,KAAK;AAC9B,QAAI,cAAe,WAAW,QAAQ,OAAO;AAC7C,QAAG,cAAc,GAAE;AACjB,kCAA4B,YAAW,YAAW,WAAW;AAAA,IAC/D;AAEA,QAAI,YAAY,cAAc,QAAQ;AACtC,gCAA4B,UAAS,YAAW,SAAS;AAEzD,cAAU,SAAQ,CAAC;AAEnB,WAAO;AAAA,MACL;AAAA,MACA,SAAQ;AAAA,QACN;AAAA,QACA;AAAA,QACA,KAAI,aAAa,SAAQ,YAAW,QAAQ;AAAA,MAC9C;AAAA,MACA,KAAI,aAAa,SAAQ,KAAK;AAAA,IAChC;AAAA,EAEF;AAGA,WAAS,gBAAgB,SAAS;AAChC,QAAI,QAAQ,cAAc,KAAK,QAAQ,MAAM;AAC7C,QAAG,OAAM;AACP,gBAAU,SAAQ,MAAM,GAAG,MAAM;AAAA,IACnC;AAAA,EACF;AAGA,WAAS,oBAAoB,SAAQ;AACnC,QAAI,QAAQ,UAAU,OAAO;AAC7B,QAAI,QAAQ,QAAQ,OAAO;AAC3B,QAAI;AACJ,QAAG,UAAU,OAAO,UAAU,KAAI;AAChC,gBAAU,SAAQ,CAAC;AACnB,YAAM,WAAW,QAAQ,OAAO,QAAQ,KAAK;AAC7C,gBAAU,cAAc,SAAQ,QAAQ;AACxC,gBAAU,SAAQ,CAAC;AAAA,IACrB;AACA,WAAO;AAAA,MACL;AAAA,MACA,KAAI,aAAa,SAAQ,KAAK;AAAA,IAChC;AAAA,EACF;AAGA,WAAS,eAAe,SAAQ;AAC9B,QAAI,QAAQ,UAAU,OAAO;AAE7B,QAAI,QAAQ,kCAAkC,KAAK,QAAQ,MAAM;AACjE,QAAI,OAAO,MAAM;AAEjB,cAAU,SAAQ,KAAK,MAAM;AAE7B,oBAAgB,OAAO;AACvB,cAAU,SAAQ,CAAC;AAEnB,QAAI,QAAQ,oBAAoB,OAAO;AAEvC,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA,OAAM;AAAA,QACJ;AAAA,SACG;AAAA,MAEL,KAAI,aAAa,SAAQ,KAAK;AAAA,IAChC;AAAA,EACF;AAGA,WAAS,gBAAgB,SAAQ;AAC/B,UAAM,QAAQ,CAAC;AAEf,WAAM,QAAQ,OAAO,UAAU,CAAC,QAAQ,OAAO,WAAW,GAAG,GAAE;AAC7D,YAAM,OAAO,eAAe,OAAO;AACnC,YAAM,KAAK,IAAI;AACf,sBAAgB,OAAO;AAAA,IACzB;AAEA,WAAO;AAAA,EACT;AAGA,WAAS,SAAS,SAAQ;AACxB,QAAI,QAAQ,UAAU,OAAO;AAG7B,QAAI,QAAQ,2BAA2B,KAAK,QAAQ,MAAM;AAC1D,UAAM,MAAM,MAAM;AAClB,cAAU,SAAQ,MAAM,GAAG,MAAM;AACjC,oBAAgB,OAAO;AAGvB,QAAI,QAAQ,gBAAgB,OAAO;AAGnC,QAAI,gBAAgB,QAAQ,OAAO,WAAW,IAAI;AAElD,cAAU,SAAQ,gBAAgB,IAAI,CAAC;AAEvC,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,UAAS,CAAC;AAAA,MACV,KAAI,aAAa,SAAQ,KAAK;AAAA,IAChC;AAAA,EACF;AAGA,WAAS,aAAa,SAAQ;AAE5B,QAAI,MAAM,SAAS,OAAO;AAG1B,QAAI,WAAW,cAAc,OAAO;AAEpC,QAAG,QAAQ,OAAO,WAAW,IAAI,GAAE;AACjC,eAAS,OAAO;AAAA,IAClB;AAEA,QAAI,MAAM,aAAa,SAAQ,IAAI,IAAI,KAAK;AAC5C,QAAI,WAAW;AACf,WAAO;AAAA,EACT;AAGO,WAAS,MAAM,UAAU;AAK9B,UAAM,UAAU,oBAAoB,QAAQ;AAE5C,QAAI,QAAQ,UAAU,OAAO;AAG7B,QAAI,QAAQ,WAAW,cAAc,OAAO,GAAE,aAAa,SAAQ,KAAK,CAAC;AAEzE,WAAO;AAAA,EACT;AAGA,WAAS,WAAW,UAAS,KAAI;AAC/B,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA,SAAS,CAAC;AAAA,IACZ;AAAA,EACF;AAGA,WAAS,cAAc,SAAQ;AAO7B,UAAM,QAAQ,CAAC;AACf,WAAM,CAAC,MAAM,OAAO,GAAE;AACpB,YAAM,SAAS,QAAQ;AACvB,UAAI;AACJ,UAAG,OAAO,WAAW,IAAI,GAAE;AACzB,eAAO,mBAAmB,OAAO;AAAA,MACnC,WAAS,OAAO,MAAM,KAAI;AACxB,eAAO,aAAa,OAAO;AAAA,MAC7B;AACA,UAAG,CAAC,MAAK;AACP,eAAO,UAAU,OAAO;AAAA,MAC1B;AACA,YAAM,KAAK,IAAI;AAAA,IACjB;AAEA,UAAM,QAAQ,CAAC,MAAK,MAAM;AACxB,UAAG,KAAK,yBAA2B,CAAC,eAAe,KAAK,KAAK,OAAO,GAAE;AACpE,cAAM,KAAK;AAAA,MACb;AAAA,IACF,CAAC;AAED,WAAO,MAAM,OAAO,OAAO;AAAA,EAC7B;;;ACtSO,WAAS,iBAAiB,MAAK,SAAQ;AAI5C,QAAG,KAAK,0BAA2B;AAEjC,aAAO,MAAM;AAIX,cAAM,WAAW,IAAI,KAAK;AAC1B,cAAM,aAAa,KAAK;AACxB,YAAI,gBAAgB,KAAK;AACzB,YAAI,KAAK,SAAS,SAAS,GAAG;AAC5B,cAAI,KAAK,SAAS,WAAW,GAAG;AAE9B,kBAAM,QAAQ,KAAK,SAAS;AAC5B,4BAAgB;AAAA,UAClB;AAAA,QACF;AAGA,aAAK,cAAc;AAAA,UACjB;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF;;;AC7BO,WAAS,oBAAoB,MAAK,SAAQ;AAI/C,QAAG,KAAK,gCAAiC;AACvC,UAAI,UAAU,KAAK,QAAQ;AAC3B,WAAK,QAAQ,UAAU,QAAQ;AAAA,IACjC;AAAA,EACF;;;ACTO,WAAS,cAAc,MAAK,SAAQ;AAGzC,QAAG,KAAK,4BAA8B,KAAK,uBAAwB;AAIjE,aAAO,MAAM;AAUX,cAAM,WAAW,KAAK;AACtB,YAAI;AAEJ,iBAAS,IAAI,GAAG,IAAI,SAAS,QAAQ,KAAK;AACxC,gBAAM,QAAQ,SAAS;AAEvB,cAAI,OAAO,KAAK,GAAG;AAEjB,qBAAS,IAAI,IAAI,GAAG,IAAI,SAAS,QAAQ,KAAK;AAC5C,oBAAM,OAAO,SAAS;AACtB,kBAAI,OAAO,IAAI,GAAG;AAEhB,oBAAI,CAAC,kBAAkB;AACrB,qCAAmB,SAAS,KAAK;AAAA,oBAC/B;AAAA,oBACA,KAAK,MAAM;AAAA,oBACX,UAAU,CAAC,KAAK;AAAA,kBAClB;AAAA,gBACF;AAEA,iCAAiB,SAAS,KAAK,OAAO,IAAI;AAE1C,yBAAS,OAAO,GAAG,CAAC;AAEpB;AAAA,cACF,OAAO;AACL,mCAAmB;AACnB;AAAA,cACF;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAEO,WAAS,OAAO,MAAM;AAC3B,WAAO,KAAK,kCAAoC,KAAK;AAAA,EACvD;;;AClDA,WAAS,uBAAuB,MAAK;AACnC,UAAM,UAAU;AAAA,MACd,aAAY;AAAA,MACZ,QAAO;AAAA,MACP,SAAQ,oBAAI,IAAI;AAAA,MAChB,OAAO,MAAK;AACV,cAAM,QAAQ,QAAQ,QAAQ,IAAI,IAAI,KAAK;AAC3C,gBAAQ,QAAQ,IAAI,MAAK,QAAM,CAAC;AAChC,eAAO;AAAA,MACT;AAAA,MACA,gBAAe;AAAA,QACb;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAGA,WAAS,SAAS,MAAK,SAAQ;AAC7B,YAAQ,cAAc;AACtB,UAAM,aAAa,QAAQ;AAC3B,UAAM,UAAU,CAAC;AACjB,aAAQA,KAAI,GAAEA,KAAI,WAAW,QAAOA,MAAI;AACtC,UAAI,SAAS,WAAWA,IAAG,MAAK,OAAO;AACvC,UAAG;AAAQ,gBAAQ,KAAK,MAAM;AAE9B,UAAG,CAAC,QAAQ;AAAa;AAAA,IAC3B;AAEA,YAAO,KAAK;AAAA;AAIR,gBAAQ,OAAO,iBAAiB;AAChC;AAAA;AAAA;AAGA,iBAAQA,KAAI,GAAEA,KAAI,KAAK,SAAS,QAAOA,MAAI;AACzC,kBAAQ,SAAS;AACjB,mBAAS,KAAK,SAASA,KAAG,OAAO;AAAA,QACnC;AAAA;AAGJ,YAAQ,cAAc;AAEtB,QAAI,IAAI,QAAQ;AAChB,WAAM,KAAI;AACR,cAAQ,GAAG;AAAA,IACb;AAAA,EACF;AAGA,WAAS,kBAAkB,MAAW,SAAc;AAClD,UAAM,EAAE,SAAS,IAAI;AAIrB,UAAM,QAAQ,SAAS;AAMvB,QAAI,MAAM,4BAA8B,MAAM,aAAa;AACzD,YAAM,cAAc,MAAM;AAC1B,WAAK,cAAc;AAAA,IACrB,OAAO;AACL,WAAK,cAAc;AAAA,IACrB;AAAA,EACF;AAGO,WAAS,UAAU,KAAK;AAE7B,UAAM,UAAU,uBAAuB,GAAG;AAE1C,aAAS,KAAI,OAAO;AAEpB,sBAAkB,KAAK,OAAO;AAE9B,QAAI,QAAQ,KAAK,GAAG,QAAQ,QAAQ,KAAK,CAAC;AAAA,EAC5C;;;ATnFO,WAAS,SAAS,UAAS;AAEhC,UAAM,MAAM,MAAM,QAAQ;AAO1B,cAAU,GAAG;AAIb,WAAO,SAAS,GAAG;AAAA,EACrB;",
  "names": ["i"]
}
